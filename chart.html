<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sepet – AlbaSpace</title>

  <!-- Site genel stilleri -->
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/shop.css">

  <!-- İkinci sayfadan gelen özel stiller -->
  <style>
    :root {
      --header-bg: #020617;
      --accent: #00c2ff;
      --page-bg: #050b27;
      --text-main: #ffffff;
      --text-muted: #9ca3af;
    }

    /* Arka plan görseli entegrasyonu */
    body { 
        background: #020617 url("/assets/images/space-bg.jpg") center/cover fixed no-repeat; 
        color: var(--text-main); 
    }
    
    /* Ödeme ikonları stilleri */
    .chart-payment-bar { display:flex; justify-content:center; margin-top: 20px; margin-bottom:18px; }
    .chart-payment-bar .payment-icons {
      position:relative;
      display: flex;
      gap:24px;
      justify-content:center;
      align-items:center;
      padding:6px 12px;
      border-radius:10px;
      z-index:3;
      background: rgba(255, 255, 255, 0.05); /* Okunurluk için hafif arka plan */
    }
    .chart-payment-bar .payment-icons img { width:52px; height:auto; opacity:0.95; }
    .chart-payment-bar .payment-icons-link {
      display:block !important;
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width:calc(100% + 36px);
      height:72px;
      background:rgba(255,255,255,0.06);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
      border-radius:10px;
      z-index:2;
      cursor:pointer;
    }

    /* WhatsApp butonu için ek stil */
    .whatsapp-btn {
        display: inline-block;
        margin-top: 10px;
        width: 100%;
        text-align: center;
        background-color: #25D366;
        color: white;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: bold;
    }
    .whatsapp-btn:hover {
        background-color: #128C7E;
    }
  
/* === YENİ EKLENEN: COOKIE POPUP STİLLERİ === */
    /* ========================================= */
    #cookie-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 9999; /* En üstte durması için */
        display: none; /* JS ile açılacak */
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .cookie-modal {
        background-color: #ffffff;
        color: #000000;
        width: 100%;
        max-width: 500px;
        padding: 40px 30px;
        box-sizing: border-box;
        text-align: center;
        position: relative;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        border-radius: 4px; /* Hafif yumuşatma */
    }

    .cookie-header {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 20px;
        letter-spacing: 1px;
        text-transform: uppercase;
    }

    .cookie-text {
        font-size: 13px;
        line-height: 1.5;
        color: #333;
        margin-bottom: 20px;
        text-align: left;
    }

    .cookie-link {
        display: block;
        margin-bottom: 25px;
        font-size: 13px;
        text-decoration: underline;
        color: #000;
        cursor: pointer;
    }

    .cookie-buttons {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .btn-cookie {
        width: 100%;
        padding: 15px;
        font-size: 14px;
        font-weight: bold;
        text-transform: uppercase;
        cursor: pointer;
        border: 1px solid #000;
        transition: transform 0.1s ease, opacity 0.2s;
    }

    /* Üst buton (Siyah) */
    .btn-accept {
        background-color: #000;
        color: #fff;
    }

    /* Alt buton (Beyaz) */
    .btn-settings {
        background-color: #fff;
        color: #000;
    }

    .btn-cookie:active {
        transform: scale(0.96);
    }
    
    @media (max-width: 600px) {
        .cookie-modal { padding: 20px; }
    }
  </style>
</head>

<body class="home-page">
  <div data-include="/header-tr.html"></div>

  <main class="home-main">

    <section class="hero">
      <div class="glass-box reveal" data-direction="left">
        <h1>Geleceğinizi Uzaya Taşıyın!</h1>
        <p class="lead">
          Markanızı uzaya gönderiyoruz! Uzay temalı reklam ve eğitim çözümlerimizle,
          markanıza be
</style>

  <!-- Scriptler -->
  <script src="/assets/js/include.js" defer></script>
  <script src="/assets/js/menu-toggle.js" defer></script>
  <script src="/assets/js/cart.js" defer></script>
</head>

<body>

  <!-- Türkçe Header -->
  <div data-include="/header-tr.html"></div>

  <main class="cart-page">
    <h1>Sepet</h1>

    <!-- Sepet ürünleri konteyneri -->
    <section id="cartItems"></section>

    <!-- Sepet özeti ve kargo hesaplama -->
    <section class="cart-summary" id="cartSummary">
      <div class="cart-total-row">
        <span>Toplam:</span>
        <span id="cartTotal">TL0.00</span>
      </div>

      <div class="shipping-estimate">
        <h2>Tahmini Kargo ve İşlem Ücreti</h2>
        <form>
          <label>
            Ülke
            <select>
              <option value="Türkiye">Türkiye</option>
              <option value="United States">Amerika Birleşik Devletleri</option>
              <option value="United Kingdom">Birleşik Krallık</option>
              <option value="Ukraine">Ukrayna</option>
              <option value="Russia">Rusya</option>
            </select>
          </label>

          <label>
            Eyalet / İl
            <input type="text" placeholder="Eyalet veya İl">
          </label>

          <label>
            Posta Kodu
            <input type="text" placeholder="Posta Kodu">
          </label>

          <button type="button" class="btn-secondary">Hesapla</button>
        </form>
      </div>

      <!-- Standart Checkout Butonu -->
      <button class="btn-primary checkout-btn" type="button">ÖDEME YAP</button>
      
      <!-- İkinci sayfadan gelen WhatsApp Butonu -->
      <a class="whatsapp-btn" href="https://wa.me/905387781018" target="_blank" rel="noopener">WHATSAPP İLE ÖDE</a>

      <!-- İkinci sayfadan gelen Ödeme İkonları -->
      <div class="chart-payment-bar">
        <div class="payment-icons" aria-hidden="true">
          <!-- Link mantığı korundu -->
          <span class="payment-icons-link" role="link" tabindex="0" onclick="location.href='/chart.html';" onkeydown="if(event.key==='Enter'){location.href='/chart.html';}"></span>
          <img src="/assets/icons/iyzico_tr.png" alt="iyzico">
          <img src="/assets/icons/mastercard.png" alt="mastercard">
          <img src="/assets/icons/visa.png" alt="visa">
        </div>
      </div>

    </section>

    <!-- Sepet boş mesajı -->
    <p id="emptyCartMessage" class="cart-empty" hidden>Sepetiniz boş.</p>
  </main>

  <!-- Türkçe Footer -->
  <div data-include="/footer-tr.html"></div>

  <script>
    /**
     * Sepet içeriğini Türkçe olarak render eden fonksiyon.
     */
    function renderCartTR() {
      const container = document.getElementById('cartItems');
      const summary = document.getElementById('cartSummary');
      const emptyMsg = document.getElementById('emptyCartMessage');
      const totalEl = document.getElementById('cartTotal');
      
      const cart = cartManager.load();

      if (!cart.length) {
        container.innerHTML = '';
        summary.style.display = 'none';
        emptyMsg.hidden = false;
        return;
      }

      emptyMsg.hidden = true;
      summary.style.display = '';

      let total = 0;

      container.innerHTML = cart.map((item, index) => {
        const itemTotal = item.price * item.qty;
        total += itemTotal;
        
        return `
          <article class="cart-item" data-index="${index}">
            <img src="${item.image}" alt="${item.name}">
            <div class="cart-item-main">
              <h2>${item.name}</h2>
              <p>${item.color ? item.color : ''}${item.size ? ' / ' + item.size : ''}</p>
              <div class="cart-item-price">TL${item.price.toFixed(2)}</div>
            </div>
            <div class="cart-item-actions">
              <div class="qty-control" data-qty>
                <button type="button" class="qty-btn" data-qty-minus>&minus;</button>
                <input type="number" min="1" value="${item.qty}" class="qty-input" data-qty-input>
                <button type="button" class="qty-btn" data-qty-plus>&plus;</button>
              </div>
              <!-- 'Remove' metni 'Kaldır' olarak değiştirildi -->
              <button type="button" class="cart-remove" data-remove>Kaldır</button>
              <div class="cart-item-total">TL${itemTotal.toFixed(2)}</div>
            </div>
          </article>
        `;
      }).join('');

      // Para birimi gösterimi TL olarak güncellendi
      totalEl.textContent = 'TL' + total.toFixed(2);

      // Event handler'ları bağla
      container.querySelectorAll('.cart-item').forEach(row => {
        const index = Number(row.dataset.index);
        const input = row.querySelector('[data-qty-input]');

        row.querySelector('[data-qty-minus]').addEventListener('click', () => {
          const value = Math.max(1, Number(input.value || '1') - 1);
          input.value = value;
          cartManager.updateQty(index, value);
          renderCartTR();
        });

        row.querySelector('[data-qty-plus]').addEventListener('click', () => {
          const value = Number(input.value || '1') + 1;
          input.value = value;
          cartManager.updateQty(index, value);
          renderCartTR();
        });

        row.querySelector('[data-remove]').addEventListener('click', () => {
          cartManager.remove(index);
          renderCartTR();
        });
      });
    }

    document.addEventListener('DOMContentLoaded', renderCartTR);
  </script>

<div id="cookie-overlay">
      <div class="cookie-modal">
          <div class="cookie-header">ALIŞVERİŞE BAŞLAMADAN ÖNCE</div>
    const revealItems = document.querySelectorAll('.reveal');

    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          obs.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.18,
      rootMargin: '0px 0px -8% 0px'
    });

    revealItems.forEach((item, index) => {
      const delay = item.dataset.direction === 'left' ? index * 0.025 : index * 0.03;
      item.style.setProperty('--reveal-delay', `${delay}s`);
      observer.observe(item);
    });
  </script>

  <script>
      // Sayfa Yüklendiğinde Popup Kontrolü
      document.addEventListener("DOMContentLoaded", function() {
          // localStorage kontrolü: Kullanıcı daha önce "kabul ettim" dedi mi?
          if (!localStorage.getItem("albaCookieSeen")) {
              document.getElementById("cookie-overlay").style.display = "flex";
          }
      });

      const acceptBtn = document.getElementById("btnAccept");
      const settingsBtn = document.getElementById("btnSettings");

      // Üst buton: Animasyon ve Kapatma
      if(acceptBtn) {
          acceptBtn.addEventListener("click", function() {
              // Butona basıldığını hissettirmek için ufak bir bekleme (opsiyonel)
              setTimeout(() => {
                  document.getElementById("cookie-overlay").style.display = "none";
                  // Kullanıcının gördüğünü tarayıcıya kaydet
                  localStorage.setItem("albaCookieSeen", "true");
              }, 200);
          });
      }

      // Alt buton: Çerez politikası sayfasına yönlendirir
      if(settingsBtn) {
          settingsBtn.addEventListener("click", function() {
               window.location.href = "cerez-politikasi.html";
          });
      }
  </script>
</body>
</html>
